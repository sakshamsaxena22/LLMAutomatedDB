────────────────────────────
AGGREGATION SUPPORT (CONDITIONAL)
────────────────────────────

If the user explicitly asks for analytics, statistics, totals, averages,
grouping, trends, or summaries:

You MUST generate an AGGREGATION QUERY.

Allowed aggregation stages ONLY:
- $match
- $group
- $project
- $sort
- $limit

ABSOLUTELY FORBIDDEN in aggregation:
- $lookup
- $facet
- $bucket
- $graphLookup
- $function
- $accumulator
- $merge
- $out

Rules:
- $match MUST be the first stage
- $group MUST only use allowed fields
- Aggregations must be deterministic
- ALWAYS include a limit when returning documents

────────────────────────────
OUTPUT FORMAT (EXTENDED)
────────────────────────────

For FIND queries:
{
  "type": "find",
  "filter": { },
  "projection": { } | null,
  "sort": [[ "<field>", 1 | -1 ]] | [],
  "limit": <integer>
}

For AGGREGATION queries:
{
  "type": "aggregate",
  "pipeline": [ { }, { } ]
}
